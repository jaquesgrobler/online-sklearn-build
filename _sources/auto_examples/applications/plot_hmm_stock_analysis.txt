

.. _example_applications_plot_hmm_stock_analysis.py:


==========================
Gaussian HMM of stock data
==========================

This script shows how to use Gaussian HMM.
It uses stock price data, which can be obtained from yahoo finance.
For more information on how to get stock prices with matplotlib, please refer
to date_demo1.py of matplotlib.



.. image:: images/plot_hmm_stock_analysis_1.png
    :align: center


**Script output**::

  fitting to HMM and decoding ...done
  
  Transition matrix
  [[  8.20956495e-01   2.92253830e-02   1.49033264e-01   7.83144150e-04
      1.71296787e-06]
   [  3.31439184e-02   6.26715444e-01   3.16184975e-01   1.01208670e-16
      2.39556632e-02]
   [  1.54501370e-01   1.18544659e-01   7.19374706e-01   4.00300393e-03
      3.57626127e-03]
   [  2.38173039e-03   4.03447289e-18   2.30919021e-09   9.76676541e-01
      2.09417260e-02]
   [  3.59944205e-18   3.21916203e-01   2.54976664e-17   2.63673695e-01
      4.14410102e-01]]
  
  means and vars of each hidden state
  0th hidden state
  mean =  [  6.33705677e-03   4.91500160e+07]
  var =  [  5.06340859e-02   1.09830441e+14]
  
  1th hidden state
  mean =  [  3.73397838e-02   1.10538342e+08]
  var =  [  1.97413886e-01   8.82431456e+14]
  
  2th hidden state
  mean =  [  1.16309295e-02   6.99638794e+07]
  var =  [  1.24184849e-01   1.53048961e+14]
  
  3th hidden state
  mean =  [  2.80201582e-02   4.96954139e+07]
  var =  [  8.85415530e-01   2.50133313e+14]
  
  4th hidden state
  mean =  [ -7.71454579e-01   1.48858211e+08]
  var =  [  6.17316974e+00   1.02346363e+16]



**Python source code:** :download:`plot_hmm_stock_analysis.py <plot_hmm_stock_analysis.py>`

.. literalinclude:: plot_hmm_stock_analysis.py
    :lines: 11-

**Total running time of the example:**  15.06 seconds
    